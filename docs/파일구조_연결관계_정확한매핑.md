# 🗂️ 운세플랫폼 파일 구조 및 연결 관계 - 정확한 매핑

📅 작성일: 2025-01-07  
🎯 목적: 실제 사용 파일과 엔진 연결 관계 명확화

---

## 📁 1. 실제 사용 파일 구조

### 🏠 메인 페이지

```
C:\xampp\htdocs\mysite\운세플랫폼\frontend\index.html
```

**역할:** 
- 메인 진입점
- 8개 기능 메뉴
- 이용권 시스템 통합
- 사주 정보 관리

**연결 파일:**
- `utils/ticket-system.js` (이용권)
- `components/common/TicketModal.jsx` (이용권 모달)

---

## 🎯 2. 기능별 파일 매핑

### 1️⃣ 오늘의 운세

#### 프론트엔드 (1개)
```
✅ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\daily-fortune-test.html
```

**역할:** UI/UX, 사용자 입력, 결과 표시

**API 호출 위치:** 라인 ~800
```javascript
async function callRealDailyFortuneAPI(requestData) {
  const response = await fetch('http://localhost:3000/api/daily-fortune', {
    method: 'POST',
    body: JSON.stringify(requestData)
  });
}
```

#### 백엔드 (1개 + 1개 프롬프트)
```
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\core\daily-engine.js
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\prompts\daily-fortune-prompt.js
```

**의존 파일:**
- `engines/utils/saju-calculator.js` (사주 계산)
- `engines/utils/element-analyzer.js` (오행 분석)
- `engines/data/five-elements.json` (오행 데이터)

#### 삭제 대상
```
❌ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\daily-fortune.html
   (이용권 시스템 없는 구버전)
```

---

### 2️⃣ 타로 카드

#### 프론트엔드 (1개)
```
✅ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\tarot-mock.html
```

**역할:** 
- 78장 타로 카드 데이터 (내장)
- 5단계 카드 선택 UI
- 결과 표시

**API 호출 위치:** 라인 ~1100
```javascript
// Claude API 호출 (해석용)
const response = await fetch('http://localhost:3000/api/tarot', {
  method: 'POST',
  body: JSON.stringify({
    cards: selectedCards,
    category: selectedCategory
  })
});
```

#### 백엔드 (1개 + 데이터)
```
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\core\tarot-engine.js
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\data\tarot-cards-complete.json (78장)
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\prompts\tarot-prompt.js
```

**의존 파일:**
- `engines/data/tarot-cards-meanings.json` (의미 데이터)

#### 삭제 대상
```
❌ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\tarot-mock-complete.html
❌ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\tarot-test.html
```

---

### 3️⃣ 사주팔자

#### 프론트엔드 (1개 HTML + 6개 JS)
```
✅ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\saju-test.html

필수 JS 모듈 (프론트엔드에서 사용):
✅ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\saju-main.js
✅ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\saju-ui-controller.js
✅ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\saju-api-functions.js
✅ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\ten-stars-calculator.js
```

**API 호출 위치:** `saju-api-functions.js`
```javascript
const response = await fetch('http://localhost:3000/api/saju', {
  method: 'POST',
  body: JSON.stringify({
    year, month, day, hour, gender, category
  })
});
```

#### 백엔드 (1개 메인 + 10개 유틸)
```
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\core\saju-engine.js (메인)
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\core\saju-engine-extended.js (대운/신살)

필수 유틸:
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\utils\saju-calculator.js ⭐ 핵심!
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\utils\ganzi-calculator.js
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\utils\daeun-calculator.js
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\utils\ten-stars-calculator.js
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\utils\element-analyzer.js
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\utils\strength-calculator.js
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\utils\yongsin-finder.js
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\utils\sinsal-calculator.js
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\utils\zodiac-calculator.js

필수 데이터:
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\data\ganzi-60.json ⭐ 60갑자
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\data\five-elements.json
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\data\ten-stars-data.json
```

#### 삭제 대상 (Mock 파일들)
```
❌ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\saju-basic-calculator.js
   (Mock 데이터 - 백엔드에 정확한 계산 있음)

❌ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\saju-extended-calculator.js
   (사용 안함 - 백엔드에 있음)

❌ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\saju-interpretations.js
   (사용 안함 - 백엔드에 있음)

❌ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\saju-test-improved.html
❌ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\saju-test-new.html
❌ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\saju-test-old-backup.html
```

---

### 4️⃣ 토정비결

#### 프론트엔드 (1개)
```
✅ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\tojeong-test.html
```

**API 호출:**
```javascript
const response = await fetch('http://localhost:3000/api/tojeong', {
  method: 'POST',
  body: JSON.stringify({ year, month, day })
});
```

#### 백엔드 (1개 + 데이터)
```
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\core\tojeong-engine.js
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\data\tojeong-gua-144.json ⭐ 144괘
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\prompts\tojeong-prompt.js
```

**의존:**
- `engines/node_modules/lunar-javascript` (음력 변환)

#### 삭제 대상
```
❌ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\tojeong.html
```

---

### 5️⃣ 꿈 해몽

#### 프론트엔드 (1개)
```
✅ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\dream.html
```

**API 호출:**
```javascript
const response = await fetch('http://localhost:3000/api/dream', {
  method: 'POST',
  body: JSON.stringify({ keyword })
});
```

#### 백엔드 (1개 + 데이터베이스)
```
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\core\dream-engine.js
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\data\dream-db.json ⭐ 꿈 데이터베이스
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\prompts\dream-prompt.js
```

**알고리즘:**
- Jaro-Winkler 유사도 검색

---

### 6️⃣ 별자리 운세

#### 프론트엔드 (1개)
```
✅ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\horoscope.html
```

**API 호출:**
```javascript
const response = await fetch('http://localhost:3000/api/horoscope', {
  method: 'POST',
  body: JSON.stringify({ birthDate })
});
```

#### 백엔드 (1개 + 데이터)
```
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\core\horoscope-engine.js
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\data\horoscope.json
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\data\horoscope-traits.json
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\prompts\horoscope-prompt.js
```

**의존:**
- `engines/utils/zodiac-calculator.js` (별자리 계산)

---

### 7️⃣ 로또 번호

#### 프론트엔드 (1개)
```
✅ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\lotto.html
```

**특징:** API 불필요 (프론트엔드에서 완결)
```javascript
// 자체 랜덤 생성
function generateLottoNumbers() {
  const numbers = [];
  while (numbers.length < 6) {
    const num = Math.floor(Math.random() * 45) + 1;
    if (!numbers.includes(num)) numbers.push(num);
  }
  return numbers.sort((a, b) => a - b);
}
```

#### 백엔드 (선택)
```
⚠️ C:\xampp\htdocs\mysite\운세플랫폼\engines\core\lotto-engine.js
   (통계 기반 번호 추천 - 선택 기능)
```

---

### 8️⃣ 궁합 보기

#### 프론트엔드 (1개)
```
✅ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\compatibility-test.html
```

**API 호출:**
```javascript
const response = await fetch('http://localhost:3000/api/compatibility', {
  method: 'POST',
  body: JSON.stringify({
    person1: { year, month, day, gender },
    person2: { year, month, day, gender }
  })
});
```

#### 백엔드 (1개)
```
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\core\compatibility-engine.js
✅ C:\xampp\htdocs\mysite\운세플랫폼\engines\prompts\compatibility-prompt.js
```

**의존:**
- `engines/utils/saju-calculator.js` (사주 기반 궁합)
- `engines/utils/zodiac-calculator.js` (띠 궁합)
- `engines/data/zodiac-animals.json` (띠 데이터)

#### 삭제 대상
```
❌ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\compatibility.html
❌ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\compatibility_fixed.html
```

---

### 9️⃣ 쿠팡 게이트 (특수)

#### 프론트엔드 (1개)
```
✅ C:\xampp\htdocs\mysite\운세플랫폼\frontend\pages\coupang-gate.html
```

**역할:** 
- 이용권 충전 안내
- 쿠팡 파트너스 링크
- 특수 목적 페이지

**API 불필요**

---

## 📋 3. 공통 시스템 파일

### 이용권 시스템 (필수)
```
✅ C:\xampp\htdocs\mysite\운세플랫폼\frontend\utils\ticket-system.js
✅ C:\xampp\htdocs\mysite\운세플랫폼\frontend\components\common\TicketModal.jsx
```

**사용:** 모든 기능 페이지

### 공통 스타일/이미지
```
✅ C:\xampp\htdocs\mysite\운세플랫폼\frontend\css\
✅ C:\xampp\htdocs\mysite\운세플랫폼\frontend\images\
✅ C:\xampp\htdocs\mysite\운세플랫폼\public\images\tarot\ (타로 카드 이미지)
```

---

## 🗑️ 4. 삭제 대상 파일 목록

### 프론트엔드 - HTML (9개)
```
❌ frontend/pages/daily-fortune.html
❌ frontend/pages/tarot-mock-complete.html
❌ frontend/pages/tarot-test.html
❌ frontend/pages/saju-test-improved.html
❌ frontend/pages/saju-test-new.html
❌ frontend/pages/saju-test-old-backup.html
❌ frontend/pages/tojeong.html
❌ frontend/pages/compatibility.html
❌ frontend/pages/compatibility_fixed.html
```

### 프론트엔드 - JS Mock 파일 (3개)
```
❌ frontend/pages/saju-basic-calculator.js (Mock - 백엔드에 정확한 계산 있음)
❌ frontend/pages/saju-extended-calculator.js (미사용)
❌ frontend/pages/saju-interpretations.js (미사용 - 백엔드에 있음)
```

### 백업 폴더 (2개)
```
❌ frontend/pages/backup_20251006_191341/
❌ frontend/pages/backup_20251006_191424/
```

**총 삭제 대상: 14개 파일 + 2개 폴더**

---

## ✅ 5. 유지할 파일 최종 목록

### 프론트엔드 (9개 HTML + 4개 JS)
```
✅ index.html
✅ pages/daily-fortune-test.html
✅ pages/tarot-mock.html
✅ pages/saju-test.html
✅ pages/tojeong-test.html
✅ pages/dream.html
✅ pages/horoscope.html
✅ pages/lotto.html
✅ pages/compatibility-test.html
✅ pages/coupang-gate.html

✅ pages/saju-main.js
✅ pages/saju-ui-controller.js
✅ pages/saju-api-functions.js
✅ pages/ten-stars-calculator.js

✅ utils/ticket-system.js
✅ components/common/TicketModal.jsx
```

### 백엔드 (8개 엔진 + 10개 유틸)
```
✅ engines/core/daily-engine.js
✅ engines/core/tarot-engine.js
✅ engines/core/saju-engine.js
✅ engines/core/saju-engine-extended.js
✅ engines/core/tojeong-engine.js
✅ engines/core/dream-engine.js
✅ engines/core/horoscope-engine.js
✅ engines/core/compatibility-engine.js
✅ engines/core/lotto-engine.js (선택)

✅ engines/utils/saju-calculator.js ⭐
✅ engines/utils/ganzi-calculator.js
✅ engines/utils/daeun-calculator.js
✅ engines/utils/ten-stars-calculator.js
✅ engines/utils/element-analyzer.js
✅ engines/utils/element-calculator.js
✅ engines/utils/strength-calculator.js
✅ engines/utils/yongsin-finder.js
✅ engines/utils/sinsal-calculator.js
✅ engines/utils/zodiac-calculator.js
```

### 데이터 파일
```
✅ engines/data/ganzi-60.json
✅ engines/data/five-elements.json
✅ engines/data/ten-stars-data.json
✅ engines/data/tarot-cards-complete.json
✅ engines/data/tojeong-gua-144.json
✅ engines/data/dream-db.json
✅ engines/data/horoscope.json
✅ engines/data/zodiac-animals.json
```

---

## 🔌 6. API 연결 요약

### 백엔드 API 서버
```
위치: C:\xampp\htdocs\mysite\운세플랫폼\backend\
실행: npm start
포트: http://localhost:3000
```

### API 엔드포인트 매핑
```
POST /api/daily-fortune    → engines/core/daily-engine.js
POST /api/tarot             → engines/core/tarot-engine.js
POST /api/saju              → engines/core/saju-engine.js
POST /api/tojeong           → engines/core/tojeong-engine.js
POST /api/dream             → engines/core/dream-engine.js
POST /api/horoscope         → engines/core/horoscope-engine.js
POST /api/compatibility     → engines/core/compatibility-engine.js
POST /api/lotto             → engines/core/lotto-engine.js (선택)
```

---

## 📝 7. 작업 체크리스트

### Phase 1: 파일 정리
- [ ] Mock JS 파일 3개 삭제
- [ ] 중복 HTML 파일 9개 삭제
- [ ] 백업 폴더 2개 삭제

### Phase 2: API 연결
- [ ] 백엔드 서버 실행 확인
- [ ] 각 프론트엔드 파일에서 Mock → Real API 전환
- [ ] Claude API 키 설정

### Phase 3: 테스트
- [ ] 8개 기능 각각 테스트
- [ ] 이용권 시스템 작동 확인
- [ ] 에러 핸들링 확인

### Phase 4: 배포
- [ ] 최종 점검
- [ ] 프로덕션 배포

---

**작성일**: 2025-01-07  
**목적**: 정확한 파일 구조 파악 및 불필요한 파일 삭제 준비  
**다음 작업**: 삭제 실행 → API 연결 → 테스트
