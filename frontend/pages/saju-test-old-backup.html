<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì‚¬ì£¼íŒ”ì - ìš°ë¦¬ì˜ ìš´ì„¸</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Malgun Gothic', sans-serif;
      background: #ffffff;
      min-height: 100vh;
      padding: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .container {
      max-width: 500px;
      width: 100%;
      background: white;
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
    }

    .header h1 {
      font-size: 28px;
      color: #333;
      margin-bottom: 10px;
    }

    .header p {
      color: #666;
      font-size: 14px;
    }

    .back-btn {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 8px 15px;
      background: #f0f0f0;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      font-size: 14px;
      text-decoration: none;
      color: #333;
    }

    .back-btn:hover {
      background: #e0e0e0;
    }

    .top-buttons {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 10px;
    }

    .header-buttons {
      display: flex;
      gap: 8px;
    }

    .top-btn {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 8px 15px;
      background: white;
      border: 2px solid #ddd;
      border-radius: 20px;
      cursor: pointer;
      font-size: 14px;
      color: #333;
    }

    .top-btn:hover {
      background: #f8f8f8;
      border-color: #667eea;
    }

    .user-info-display {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 20px;
      text-align: center;
      font-size: 14px;
      color: #666;
    }

    .generate-btn {
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      margin-bottom: 30px;
      transition: all 0.3s;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    }

    .generate-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    .loading {
      text-align: center;
      padding: 40px;
      display: none;
    }

    .loading.show {
      display: block;
    }

    .spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #667eea;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .result-container {
      display: none;
      animation: fadeIn 0.5s;
    }

    .result-container.show {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .saju-card {
      background: linear-gradient(135deg, #fff9e6 0%, #ffe8b3 100%);
      padding: 25px;
      border-radius: 15px;
      margin-bottom: 25px;
      border: 2px solid #ffd700;
      box-shadow: 0 4px 15px rgba(255, 215, 0, 0.2);
    }

    .saju-card h3 {
      color: #f39c12;
      margin-bottom: 18px;
      font-size: 20px;
      text-align: center;
      padding-bottom: 12px;
      border-bottom: 2px solid #ffd700;
    }

    .saju-pillars {
      display: flex;
      justify-content: space-around;
      margin: 20px 0;
    }

    .pillar {
      text-align: center;
    }

    .pillar-label {
      font-size: 12px;
      color: #666;
      margin-bottom: 5px;
    }

    .pillar-value {
      font-size: 24px;
      font-weight: bold;
      color: #2d3436;
    }

    .elements-chart {
      margin: 20px 0;
    }

    .element-bar {
      margin-bottom: 12px;
    }

    .element-label {
      display: flex;
      justify-content: space-between;
      margin-bottom: 5px;
      font-size: 14px;
    }

    .bar {
      height: 20px;
      background: #e0e0e0;
      border-radius: 10px;
      overflow: hidden;
    }

    .bar-fill {
      height: 100%;
      transition: width 0.5s;
    }

    .element-ëª© { background: #00b894; }
    .element-í™” { background: #d63031; }
    .element-í†  { background: #fdcb6e; }
    .element-ê¸ˆ { background: #b2bec3; }
    .element-ìˆ˜ { background: #0984e3; }

    .fortune-card {
      background: white;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 15px;
      transition: all 0.3s;
    }

    .fortune-card:hover {
      border-color: #667eea;
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.1);
    }

    .fortune-card h3 {
      color: #667eea;
      font-size: 18px;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .fortune-card p {
      color: #555;
      line-height: 1.8;
      font-size: 15px;
    }

    .action-buttons {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }

    .action-btn {
      flex: 1;
      padding: 14px;
      border: 2px solid #667eea;
      background: white;
      color: #667eea;
      border-radius: 10px;
      font-size: 15px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
    }

    .action-btn:hover {
      background: #667eea;
      color: white;
    }

    .error {
      text-align: center;
      padding: 40px;
      color: #e74c3c;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- ìƒë‹¨ ë²„íŠ¼ -->
    <div class="top-buttons">
      <a href="../index.html" class="back-btn">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M19 12H5M12 19l-7-7 7-7"/>
        </svg>
        ë’¤ë¡œê°€ê¸°
      </a>
      
      <div class="header-buttons">
        <button class="top-btn" onclick="openModal()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
          </svg>
          ì‚¬ì£¼ë³€ê²½
        </button>
        
        <button class="top-btn" onclick="shareSaju()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="18" cy="5" r="3"/>
            <circle cx="6" cy="12" r="3"/>
            <circle cx="18" cy="19" r="3"/>
            <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/>
            <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/>
          </svg>
          ê³µìœ í•˜ê¸°
        </button>
      </div>
    </div>

    <!-- í—¤ë” -->
    <div class="header">
      <h1>ğŸ”® ì‚¬ì£¼íŒ”ì</h1>
      <p>ë‹¹ì‹ ì˜ ìš´ëª…ì„ ê¹Šì´ ë“¤ì—¬ë‹¤ë´…ë‹ˆë‹¤</p>
    </div>

    <!-- ì‚¬ìš©ì ì •ë³´ í‘œì‹œ -->
    <div class="user-info-display" id="userInfo">
      ì‚¬ì£¼ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
    </div>

    <!-- ì‚¬ì£¼ ë³´ê¸° ë²„íŠ¼ -->
    <button class="generate-btn" onclick="calculateSaju()">
      ì‚¬ì£¼ ë³´ê¸°
    </button>

    <!-- ë¡œë”© -->
    <div class="loading" id="loading">
      <div class="spinner"></div>
      <p>ì‚¬ì£¼ë¥¼ ê³„ì‚°í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>
      <p style="font-size: 12px; color: #999; margin-top: 10px;">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”</p>
    </div>

    <!-- ê²°ê³¼ -->
    <div class="result-container" id="resultContainer">
      <!-- JavaScriptë¡œ ì±„ì›Œì§ -->
    </div>

    <!-- ë©´ì±…ì¡°í•­ -->
    <div style="margin-top: 40px; padding: 20px; background: #f8f9fa; border-radius: 10px; border-top: 2px solid #e0e0e0;">
      <p style="font-size: 12px; color: #999; line-height: 1.8; margin-bottom: 10px;">
        âš ï¸ <strong>ë©´ì±…ì¡°í•­</strong>
      </p>
      <p style="font-size: 11px; color: #666; line-height: 1.8; text-align: justify;">
        ì‚¬ì£¼íŒ”ì, ìš´ì„¸, ê¿ˆí•´ëª½ ë“± ë³¸ ì„œë¹„ìŠ¤ì—ì„œ ì œê³µí•˜ëŠ” ëª¨ë“  ì½˜í…ì¸ ëŠ” <strong>ì°¸ê³ ìš© ì •ë³´ì¼ ë¿ì´ë©°</strong>,
        ì–´ë– í•œ ê³¼í•™ì Â·ì˜í•™ì Â·ë²•ì  ê·¼ê±°ë‚˜ ë³´ì¦ì„ ì œê³µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
        ë³¸ ì„œë¹„ìŠ¤ì˜ ë‚´ìš©ì€ <strong>ê°œì¸ì˜ íŒë‹¨ì´ë‚˜ ì˜ì‚¬ê²°ì •ì˜ ìœ ì¼í•œ ê·¼ê±°ë¡œ ì‚¬ìš©ë˜ì–´ì„œëŠ” ì•ˆ ë˜ë©°</strong>,
        ì¤‘ìš”í•œ ê²°ì •ì€ ë°˜ë“œì‹œ ì „ë¬¸ê°€ì™€ ìƒë‹´í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.
        ë³¸ ì„œë¹„ìŠ¤ ì´ìš©ìœ¼ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ì–´ë– í•œ ì§ì ‘ì Â·ê°„ì ‘ì  ì†í•´ì— ëŒ€í•´ì„œë„
        ë‹¹ì‚¬ëŠ” ë²•ì  ì±…ì„ì„ ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤.
      </p>
    </div>
  </div>

  <script>
    // localStorageì—ì„œ ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸°
    let savedData = JSON.parse(localStorage.getItem('fortuneUserData')) || {
      gender: 'ë‚¨ì„±',
      calendarType: 'ìŒë ¥(í‰ë‹¬)',
      year: '1984',
      month: '7',
      day: '7',
      birthTime: 'æœª(13:31~15:30)'
    };

    // ì‚¬ìš©ì ì •ë³´ í‘œì‹œ
    function loadUserInfo() {
      const userInfoText = `${savedData.gender} ${savedData.year}. ${savedData.month}. ${savedData.day} (${savedData.calendarType}) ${savedData.birthTime}`;
      document.getElementById('userInfo').textContent = userInfoText;
    }

    // ì‚¬ì£¼ë³€ê²½ ëª¨ë‹¬ ì—´ê¸° (index.htmlì˜ ëª¨ë‹¬ ì‚¬ìš©)
    function openModal() {
      window.location.href = '../index.html#open-modal';
    }

    // ê³µìœ í•˜ê¸°
    function shareSaju() {
      const shareText = `${savedData.gender} ${savedData.year}ë…„ ${savedData.month}ì›” ${savedData.day}ì¼ìƒ ì‚¬ì£¼íŒ”ì ë³´ê¸°`;
      
      if (navigator.share) {
        navigator.share({
          title: 'ì‚¬ì£¼íŒ”ì',
          text: shareText,
          url: window.location.href
        }).catch(() => {});
      } else {
        const tempInput = document.createElement('input');
        tempInput.value = window.location.href;
        document.body.appendChild(tempInput);
        tempInput.select();
        document.execCommand('copy');
        document.body.removeChild(tempInput);
        alert('ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
      }
    }

    // ì˜¤í–‰ ë°ì´í„°
    const elements = {
      ì²œê°„: {'ê°‘':'ëª©','ì„':'ëª©','ë³‘':'í™”','ì •':'í™”','ë¬´':'í† ','ê¸°':'í† ','ê²½':'ê¸ˆ','ì‹ ':'ê¸ˆ','ì„':'ìˆ˜','ê³„':'ìˆ˜'},
      ì§€ì§€: {'ì':'ìˆ˜','ì¶•':'í† ','ì¸':'ëª©','ë¬˜':'ëª©','ì§„':'í† ','ì‚¬':'í™”','ì˜¤':'í™”','ë¯¸':'í† ','ì‹ ':'ê¸ˆ','ìœ ':'ê¸ˆ','ìˆ ':'í† ','í•´':'ìˆ˜'}
    };

    // ì‚¬ì£¼ ê³„ì‚° (Mock)
    function calculateSaju() {
      // ë¡œë”© í‘œì‹œ
      document.getElementById('loading').classList.add('show');
      document.getElementById('resultContainer').classList.remove('show');

      // Mock ê³„ì‚° (0.8ì´ˆ ëŒ€ê¸°)
      setTimeout(() => {
        const sajuResult = getMockSajuResult();
        displayResult(sajuResult);
        
        document.getElementById('loading').classList.remove('show');
        document.getElementById('resultContainer').classList.add('show');
      }, 800);
    }

    // Mock ì‚¬ì£¼ ê²°ê³¼
    function getMockSajuResult() {
      const year = parseInt(savedData.year);
      const month = parseInt(savedData.month);
      const day = parseInt(savedData.day);
      
      // ê°„ë‹¨í•œ ê³„ì‚°
      const yearGanzi = {cheongan: 'ê°‘', jiji: 'ì', hanja: 'ê°‘ì'};
      const monthGanzi = {cheongan: 'ê²½', jiji: getMonthJiji(month), hanja: `ê²½${getMonthJiji(month)}`};
      const dayGanzi = {cheongan: 'ì‹ ', jiji: 'ë¬˜', hanja: 'ì‹ ë¬˜'};
      const hourJiji = extractHourJiji(savedData.birthTime);
      const hourGanzi = {cheongan: 'ì‹ ', jiji: hourJiji, hanja: `ì‹ ${hourJiji}`};

      const elementsCount = calculateElements(yearGanzi, monthGanzi, dayGanzi, hourGanzi);
      const ilgan = dayGanzi.cheongan;
      const strength = calculateStrength(elementsCount, ilgan);
      const yongsin = findYongsin(strength, elementsCount);

      return {
        saju: {year: yearGanzi, month: monthGanzi, day: dayGanzi, hour: hourGanzi, ilgan: ilgan},
        elements: elementsCount,
        strength: strength,
        yongsin: yongsin,
        interpretations: generateInterpretations(ilgan, elementsCount, strength, yongsin)
      };
    }

    // ì›” ì§€ì§€ ê°€ì ¸ì˜¤ê¸°
    function getMonthJiji(month) {
      const monthJiji = ['ì¸','ë¬˜','ì§„','ì‚¬','ì˜¤','ë¯¸','ì‹ ','ìœ ','ìˆ ','í•´','ì','ì¶•'];
      return monthJiji[month - 1];
    }

    // ì‹œê°„ì—ì„œ ì§€ì§€ ì¶”ì¶œ
    function extractHourJiji(birthTime) {
      const match = birthTime.match(/^(.)/);
      return match ? match[1] : 'ë¯¸';
    }

    // ì˜¤í–‰ ê³„ì‚°
    function calculateElements(year, month, day, hour) {
      const count = {ëª©: 0, í™”: 0, í† : 0, ê¸ˆ: 0, ìˆ˜: 0};
      [year, month, day, hour].forEach(ganzi => {
        const chEl = elements.ì²œê°„[ganzi.cheongan];
        const jiEl = elements.ì§€ì§€[ganzi.jiji];
        if (chEl) count[chEl]++;
        if (jiEl) count[jiEl]++;
      });
      return count;
    }

    // ì‹ ê°•/ì‹ ì•½ íŒì •
    function calculateStrength(elementsCount, ilgan) {
      const ilganEl = elements.ì²œê°„[ilgan];
      const same = elementsCount[ilganEl];
      return same >= 3 ? 'ì‹ ê°•' : 'ì‹ ì•½';
    }

    // ìš©ì‹  ì°¾ê¸°
    function findYongsin(strength, elementsCount) {
      const min = Object.keys(elementsCount).reduce((a, b) => 
        elementsCount[a] < elementsCount[b] ? a : b
      );
      return min;
    }

    // í•´ì„ ìƒì„±
    function generateInterpretations(ilgan, elementsCount, strength, yongsin) {
      const gender = savedData.gender;
      return {
        ì´ìš´: `ì¼ê°„ì´ ${ilgan}ì¸ ì‚¬ëŒì€ íŠ¹ë³„í•œ ì„±ê²©ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ${strength} ì‚¬ì£¼ë¡œì„œ, ìì‹ ë§Œì˜ í™•ê³ í•œ ê°€ì¹˜ê´€ì„ ì§€ë‹ˆê³  ìˆìŠµë‹ˆë‹¤. ì˜¤í–‰ ë¶„í¬ëŠ” ëª©${elementsCount.ëª©}ê°œ, í™”${elementsCount.í™”}ê°œ, í† ${elementsCount.í† }ê°œ, ê¸ˆ${elementsCount.ê¸ˆ}ê°œ, ìˆ˜${elementsCount.ìˆ˜}ê°œë¡œ ë‚˜íƒ€ë‚˜ë©°, ì´ëŠ” ë‹¹ì‹ ì˜ ì¸ìƒì—ì„œ ê· í˜•ê³¼ ì¡°í™”ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤. ìš©ì‹ ì¸ ${yongsin} ì˜¤í–‰ì„ í™œìš©í•˜ë©´ ë”ìš± í’ìš”ë¡œìš´ ì‚¶ì„ ì‚´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìì—°ê³¼ ê°€ê¹Œì´í•˜ê³ , ë”°ëœ»í•œ ë§ˆìŒì„ ìœ ì§€í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.`,
        
        ì¬ë¬¼ìš´: `ì¬ì„±ì˜ ë°°ì¹˜ë¥¼ ë³´ë©´ ${strength === 'ì‹ ê°•' ? 'ì ê·¹ì ì¸ íˆ¬ìë³´ë‹¤ëŠ” ì•ˆì •ì ì¸ ì €ì¶•ì´ ìœ ë¦¬' : 'ê¾¸ì¤€í•œ ë…¸ë ¥ìœ¼ë¡œ ì¬ë¬¼ì„ ëª¨ì„ ìˆ˜ ìˆìŒ'}í•©ë‹ˆë‹¤. ìš©ì‹  ${yongsin}ê³¼ ê´€ë ¨ëœ ì‚¬ì—…ì´ë‚˜ íˆ¬ìë¥¼ ê³ ë ¤í•´ë³´ì„¸ìš”. ë¬´ë¦¬í•œ íˆ¬ìëŠ” í”¼í•˜ê³ , ì¥ê¸°ì ì¸ ê´€ì ì—ì„œ ì¬í…Œí¬ë¥¼ í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. íŠ¹íˆ ${yongsin} ê¸°ìš´ì´ ê°•í•œ ë¶„ì•¼ì—ì„œ ì¬ë¬¼ìš´ì´ ì¢‹ìŠµë‹ˆë‹¤.`,
        
        ì• ì •ìš´: gender === 'ì—¬ì„±' 
          ? `ê´€ì„±(ë‚¨í¸)ì˜ ë°°ì¹˜ë¥¼ ë³´ë©´ ${strength === 'ì‹ ê°•' ? 'ê°•í•œ ì„±ê²©ìœ¼ë¡œ ë°°ìš°ìì™€ ì¡°í™”ë¥¼ ì´ë£¨ë ¤ ë…¸ë ¥ì´ í•„ìš”' : 'ë¶€ë“œëŸ¬ìš´ ì„±ê²©ìœ¼ë¡œ ì¢‹ì€ ë°°ìš°ììš´'}í•©ë‹ˆë‹¤. ìš©ì‹  ${yongsin} ì˜¤í–‰ì´ ê°•í•œ ìƒëŒ€ë¥¼ ë§Œë‚˜ë©´ ì¢‹ì€ ì¸ì—°ì´ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê²°í˜¼ í›„ì—ëŠ” ìƒëŒ€ë°©ì˜ ì˜ê²¬ì„ ì¡´ì¤‘í•˜ê³ , ì†Œí†µì„ ì¤‘ì‹œí•˜ë©´ í–‰ë³µí•œ ê°€ì •ì„ ê¾¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.`
          : `ì¬ì„±(ì•„ë‚´)ì˜ ë°°ì¹˜ë¥¼ ë³´ë©´ ì•ˆì •ì ì¸ ê°€ì •ì„ ê¾¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ${strength} ì‚¬ì£¼ëŠ” ë°°ìš°ìì—ê²Œ ${strength === 'ì‹ ê°•' ? 'ë¦¬ë”ì‹­ì„ ë°œíœ˜' : 'ë°°ë ¤ì‹¬ì„ ë³´ì´ë©°'}í•˜ê²Œ ë©ë‹ˆë‹¤. ê°€ì •ì„ ì†Œì¤‘íˆ ì—¬ê¸°ê³ , ë°°ìš°ìì™€ì˜ ëŒ€í™”ë¥¼ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ë©´ ì›ë§Œí•œ ë¶€ë¶€ ê´€ê³„ë¥¼ ìœ ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`,
        
        ê±´ê°•ìš´: `ì˜¤í–‰ ë¶„í¬ë¥¼ ë³´ë©´ ê· í˜•ì„ ë§ì¶”ê¸° ìœ„í•´ ${yongsin} ê¸°ìš´ì„ ë³´ì¶©í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. ${yongsin}ì— í•´ë‹¹í•˜ëŠ” ìŒì‹(${getElementFood(yongsin)})ê³¼ ìƒ‰ìƒ(${getElementColor(yongsin)})ì„ í™œìš©í•˜ë©´ ê±´ê°•ì— ë„ì›€ì´ ë©ë‹ˆë‹¤. ê·œì¹™ì ì¸ ìƒí™œê³¼ ì¶©ë¶„í•œ íœ´ì‹ì´ ì¤‘ìš”í•˜ë©°, íŠ¹íˆ ${getWeakOrgan(yongsin)} ë¶€ìœ„ë¥¼ ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤.`
      };
    }

    // ì˜¤í–‰ë³„ ìŒì‹
    function getElementFood(element) {
      const foods = {
        ëª©: 'í‘¸ë¥¸ ì±„ì†Œ, ì‹ ë§› ìŒì‹',
        í™”: 'ë¶‰ì€ ê³¼ì¼, ì“´ë§› ìŒì‹',
        í† : 'ê³¡ë¬¼, ë‹¨ë§› ìŒì‹',
        ê¸ˆ: 'ê²¬ê³¼ë¥˜, ë§¤ìš´ë§› ìŒì‹',
        ìˆ˜: 'í•´ì‚°ë¬¼, ì§ ë§› ìŒì‹'
      };
      return foods[element];
    }

    // ì˜¤í–‰ë³„ ìƒ‰ìƒ
    function getElementColor(element) {
      const colors = {
        ëª©: 'ë…¹ìƒ‰, ì²­ìƒ‰',
        í™”: 'ì ìƒ‰, ì£¼í™©ìƒ‰',
        í† : 'í™©ìƒ‰, ê°ˆìƒ‰',
        ê¸ˆ: 'ë°±ìƒ‰, ê¸ˆìƒ‰',
        ìˆ˜: 'í‘ìƒ‰, ë‚¨ìƒ‰'
      };
      return colors[element];
    }

    // ì˜¤í–‰ë³„ ì£¼ì˜ ì¥ê¸°
    function getWeakOrgan(element) {
      const organs = {
        ëª©: 'ê°„, ë‹´',
        í™”: 'ì‹¬ì¥, ì†Œì¥',
        í† : 'ë¹„ì¥, ìœ„',
        ê¸ˆ: 'í, ëŒ€ì¥',
        ìˆ˜: 'ì‹ ì¥, ë°©ê´‘'
      };
      return organs[element];
    }

    // ê²°ê³¼ í‘œì‹œ
    function displayResult(data) {
      const resultDiv = document.getElementById('resultContainer');
      
      // ì‚¬ì£¼ 8ê¸€ì
      const pillarsHTML = `
        <div class="pillar">
          <div class="pillar-label">ë…„ì£¼</div>
          <div class="pillar-value">${data.saju.year.hanja}</div>
        </div>
        <div class="pillar">
          <div class="pillar-label">ì›”ì£¼</div>
          <div class="pillar-value">${data.saju.month.hanja}</div>
        </div>
        <div class="pillar">
          <div class="pillar-label">ì¼ì£¼</div>
          <div class="pillar-value">${data.saju.day.hanja}</div>
        </div>
        <div class="pillar">
          <div class="pillar-label">ì‹œì£¼</div>
          <div class="pillar-value">${data.saju.hour.hanja}</div>
        </div>
      `;

      // ì˜¤í–‰ ì°¨íŠ¸
      const total = Object.values(data.elements).reduce((a, b) => a + b, 0);
      const elementsHTML = Object.entries(data.elements).map(([name, count]) => {
        const percentage = (count / total) * 100;
        const hanja = {ëª©:'æœ¨',í™”:'ç«',í† :'åœŸ',ê¸ˆ:'é‡‘',ìˆ˜:'æ°´'}[name];
        return `
          <div class="element-bar">
            <div class="element-label">
              <span>${name}(${hanja})</span>
              <span>${count}ê°œ</span>
            </div>
            <div class="bar">
              <div class="bar-fill element-${name}" style="width: ${percentage}%"></div>
            </div>
          </div>
        `;
      }).join('');

      // HTML ìƒì„±
      resultDiv.innerHTML = `
        <div class="saju-card">
          <h3>ğŸ“… ì‚¬ì£¼ 8ê¸€ì</h3>
          <div class="saju-pillars">${pillarsHTML}</div>
          <p style="text-align: center; margin-top: 15px;">
            ì¼ê°„: <strong style="color: #f39c12; font-size: 18px;">${data.saju.ilgan}</strong>
          </p>
        </div>

        <div class="saju-card">
          <h3>ğŸŒˆ ì˜¤í–‰ ë¶„í¬</h3>
          <div class="elements-chart">${elementsHTML}</div>
          <p style="text-align: center; margin-top: 15px; padding-top: 15px; border-top: 1px solid #ffd700;">
            ì‹ ê°•/ì‹ ì•½: <strong style="color: #e74c3c;">${data.strength}</strong> &nbsp;|&nbsp; 
            ìš©ì‹ : <strong style="color: #3498db;">${data.yongsin}</strong>
          </p>
        </div>

        <div class="fortune-card">
          <h3>ğŸ“– ì´ìš´</h3>
          <p>${data.interpretations.ì´ìš´}</p>
        </div>

        <div class="fortune-card">
          <h3>ğŸ’° ì¬ë¬¼ìš´</h3>
          <p>${data.interpretations.ì¬ë¬¼ìš´}</p>
        </div>

        <div class="fortune-card">
          <h3>ğŸ’• ì• ì •ìš´</h3>
          <p>${data.interpretations.ì• ì •ìš´}</p>
        </div>

        <div class="fortune-card">
          <h3>ğŸ¥ ê±´ê°•ìš´</h3>
          <p>${data.interpretations.ê±´ê°•ìš´}</p>
        </div>

        <div class="action-buttons">
          <button class="action-btn" onclick="location.reload()">ë‹¤ì‹œ ë³´ê¸°</button>
          <button class="action-btn" onclick="copySaju()">ì‚¬ì£¼ ë³µì‚¬</button>
        </div>
      `;
    }

    // ì‚¬ì£¼ ë³µì‚¬
    function copySaju() {
      const sajuText = document.getElementById('resultContainer').innerText;
      navigator.clipboard.writeText(sajuText).then(() => {
        alert('ì‚¬ì£¼ ë‚´ìš©ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
      }).catch(() => {
        alert('ë³µì‚¬ ì‹¤íŒ¨');
      });
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ
    window.onload = function() {
      loadUserInfo();
    }
    
    // í˜ì´ì§€ê°€ ë‹¤ì‹œ ë³´ì¼ ë•Œë§ˆë‹¤ (ë’¤ë¡œê°€ê¸° í¬í•¨) localStorageì—ì„œ ìµœì‹  ì •ë³´ ê°€ì ¸ì˜¤ê¸°
    window.addEventListener('pageshow', function(event) {
      const latestData = localStorage.getItem('fortuneUserData');
      if (latestData) {
        savedData = JSON.parse(latestData);
        loadUserInfo();
      }
    });

    // focus ì´ë²¤íŠ¸ë¡œë„ í™•ì¸ (íƒ­ ì „í™˜ ì‹œ)
    window.addEventListener('focus', function() {
      const latestData = localStorage.getItem('fortuneUserData');
      if (latestData) {
        savedData = JSON.parse(latestData);
        loadUserInfo();
      }
    });
  </script>
</body>
</html>
