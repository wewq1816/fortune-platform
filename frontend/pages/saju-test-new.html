<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>사주팔자 - 우리의 운세</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Malgun Gothic', sans-serif;
      background: #ffffff;
      min-height: 100vh;
      padding: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .container {
      max-width: 600px;
      width: 100%;
      background: white;
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
    }

    .header h1 {
      font-size: 28px;
      color: #333;
      margin-bottom: 10px;
    }

    .header p {
      color: #666;
      font-size: 14px;
    }

    .back-btn {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 8px 15px;
      background: #f0f0f0;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      font-size: 14px;
      text-decoration: none;
      color: #333;
      margin-bottom: 20px;
    }

    .back-btn:hover {
      background: #e0e0e0;
    }

    .user-info-display {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 20px;
      text-align: center;
      font-size: 14px;
      color: #666;
    }

    .generate-btn {
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      margin-bottom: 30px;
      transition: all 0.3s;
    }

    .generate-btn:hover {
      transform: translateY(-2px);
    }

    .loading {
      text-align: center;
      padding: 40px;
      display: none;
    }

    .loading.show {
      display: block;
    }

    .spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #667eea;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .category-menu {
      overflow-x: auto;
      white-space: nowrap;
      margin-bottom: 30px;
      padding: 10px 0;
      border-bottom: 2px solid #f0f0f0;
      -webkit-overflow-scrolling: touch;
    }

    .category-menu::-webkit-scrollbar {
      height: 6px;
    }

    .category-menu::-webkit-scrollbar-thumb {
      background: #ddd;
      border-radius: 3px;
    }

    .category-btn {
      display: inline-block;
      padding: 10px 20px;
      margin-right: 10px;
      background: #f8f9fa;
      border: 2px solid #e0e0e0;
      border-radius: 20px;
      cursor: pointer;
      font-size: 14px;
      color: #666;
      transition: all 0.3s;
    }

    .category-btn:hover {
      background: #e8e9ea;
      border-color: #667eea;
    }

    .category-btn.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-color: #667eea;
      color: white;
      font-weight: bold;
    }

    .saju-card {
      background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 20px;
      box-shadow: 0 10px 30px rgba(253, 203, 110, 0.3);
    }

    .saju-card h3 {
      font-size: 20px;
      margin-bottom: 20px;
      color: #2d3436;
    }

    .saju-pillars {
      display: flex;
      justify-content: space-around;
      gap: 10px;
    }

    .pillar {
      background: white;
      border-radius: 12px;
      padding: 15px 10px;
      text-align: center;
      flex: 1;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    .pillar-label {
      font-size: 12px;
      color: #636e72;
      margin-bottom: 10px;
      font-weight: bold;
    }

    .pillar-char {
      font-size: 24px;
      font-weight: bold;
      color: #2d3436;
    }

    .elements-chart {
      background: white;
      border-radius: 10px;
      padding: 15px;
    }

    .element-bar {
      margin-bottom: 12px;
    }

    .element-label {
      display: flex;
      justify-content: space-between;
      margin-bottom: 5px;
      font-size: 14px;
      color: #636e72;
    }

    .bar {
      height: 20px;
      background: #f0f0f0;
      border-radius: 10px;
      overflow: hidden;
    }

    .bar-fill {
      height: 100%;
      border-radius: 10px;
      transition: width 0.5s;
    }

    .element-목 { background: linear-gradient(90deg, #55efc4, #00b894); }
    .element-화 { background: linear-gradient(90deg, #ff7675, #d63031); }
    .element-토 { background: linear-gradient(90deg, #fdcb6e, #e17055); }
    .element-금 { background: linear-gradient(90deg, #dfe6e9, #b2bec3); }
    .element-수 { background: linear-gradient(90deg, #74b9ff, #0984e3); }

    .fortune-card {
      background: white;
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 20px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    }

    .fortune-card h3 {
      font-size: 20px;
      margin-bottom: 15px;
      color: #2d3436;
      border-bottom: 2px solid #f0f0f0;
      padding-bottom: 10px;
    }

    .fortune-card p {
      line-height: 1.8;
      color: #636e72;
      font-size: 15px;
    }

    .action-buttons {
      display: flex;
      gap: 10px;
      margin-top: 30px;
    }

    .action-btn {
      flex: 1;
      padding: 15px;
      background: white;
      border: 2px solid #ddd;
      border-radius: 12px;
      cursor: pointer;
      font-size: 16px;
      color: #333;
      transition: all 0.3s;
    }

    .action-btn:hover {
      background: #f8f8f8;
      border-color: #667eea;
    }

    #resultContainer {
      display: none;
    }

    #resultContainer.show {
      display: block;
    }
  </style>
</head>
<body>
  <div class="container">
    <a href="../index.html" class="back-btn">← 돌아가기</a>
    
    <div class="header">
      <h1>사주팔자</h1>
      <p>당신의 사주를 상세하게 분석해드립니다</p>
    </div>

    <div class="user-info-display" id="userInfoDisplay">
      사주 정보를 불러오는 중...
    </div>

    <button class="generate-btn" onclick="generateSaju()">사주 보기</button>

    <div class="loading" id="loading">
      <div class="spinner"></div>
      <p>사주를 분석하고 있습니다...</p>
    </div>

    <div id="resultContainer">
      <div class="category-menu" id="categoryMenu">
        <button class="category-btn active" onclick="showCategory('total')">총운</button>
        <button class="category-btn" onclick="showCategory('personality')">성격/장단점</button>
        <button class="category-btn" onclick="showCategory('daeun')">대운</button>
        <button class="category-btn" onclick="showCategory('wealth')">재물운</button>
        <button class="category-btn" onclick="showCategory('love')">애정운</button>
        <button class="category-btn" onclick="showCategory('health')">건강운</button>
        <button class="category-btn" onclick="showCategory('career')">직업운</button>
        <button class="category-btn" onclick="showCategory('study')">학업운</button>
        <button class="category-btn" onclick="showCategory('promotion')">승진운</button>
        <button class="category-btn" onclick="showCategory('move')">이동운</button>
        <button class="category-btn" onclick="showCategory('travel')">여행운</button>
        <button class="category-btn" onclick="showCategory('parents')">부모운</button>
        <button class="category-btn" onclick="showCategory('siblings')">형제운</button>
        <button class="category-btn" onclick="showCategory('children')">자녀운</button>
        <button class="category-btn" onclick="showCategory('spouse')">배우자운</button>
        <button class="category-btn" onclick="showCategory('social')">대인관계운</button>
        <button class="category-btn" onclick="showCategory('aptitude')">직업 적성</button>
        <button class="category-btn" onclick="showCategory('job')">어울리는 직업</button>
        <button class="category-btn" onclick="showCategory('business')">사업 성공</button>
        <button class="category-btn" onclick="showCategory('sinsal')">신살</button>
        <button class="category-btn" onclick="showCategory('taekil')">택일</button>
      </div>

      <div id="sajuBasicInfo"></div>
      <div id="categoryResult"></div>

      <div class="action-buttons">
        <button class="action-btn" onclick="location.reload()">다시 보기</button>
        <button class="action-btn" onclick="copySaju()">내용 복사</button>
      </div>
    </div>
  </div>

  <script>
    let savedData = null;
    let currentSajuData = null;
    let currentCategory = 'total';

    function loadUserInfo() {
      const data = localStorage.getItem('fortuneUserData');
      if (data) {
        savedData = JSON.parse(data);
        const display = document.getElementById('userInfoDisplay');
        const birthDate = savedData.isLunar ? savedData.birthDate + ' (음력)' : savedData.birthDate;
        display.innerHTML = `<strong>${savedData.name || '사용자'}</strong>님<br>생년월일: ${birthDate}<br>생시: ${savedData.birthTime}`;
      } else {
        alert('사용자 정보가 없습니다.');
        location.href = '../index.html';
      }
    }

    async function generateSaju() {
      if (!savedData) {
        alert('사용자 정보가 없습니다.');
        return;
      }
      document.getElementById('loading').classList.add('show');
      setTimeout(() => {
        currentSajuData = getMockSajuResult();
        displaySajuBasic(currentSajuData);
        showCategory('total');
        document.getElementById('loading').classList.remove('show');
        document.getElementById('resultContainer').classList.add('show');
      }, 500);
    }

    function getMockSajuResult() {
      return {
        saju: {
          year: { cheongan: '경', jiji: '오', hanja: '경오' },
          month: { cheongan: '무', jiji: '오', hanja: '무오' },
          day: { cheongan: '계', jiji: '축', hanja: '계축' },
          hour: { cheongan: '갑', jiji: '인', hanja: '갑인' },
          ilgan: '계수(癸水)'
        },
        elements: { 목: 1, 화: 2, 토: 2, 금: 1, 수: 2 },
        strength: '신약',
        yongsin: '금(金)',
        interpretations: {
          total: '당신은 계수 일간으로 태어나 부드럽고 융통성 있는 성격을 가지고 있습니다. 오행 분석 결과 화와 토가 강하여 열정적이고 현실적인 면이 있습니다. 신약 사주로 타인과의 협력이 중요하며, 용신인 금을 활용하면 인생의 균형을 잡을 수 있습니다.',
          personality: '성격이 온화하고 배려심이 깊습니다. 장점은 적응력이 빠르고, 타인의 말을 잘 경청하며, 창의적인 해결책을 찾는 능력이 있다는 것입니다. 단점으로는 때로 우유부단하고, 자신의 의견을 강하게 표현하지 못하는 경향이 있습니다.',
          daeun: '현재 3-13세 대운 시기에는 기초를 다지는 시기입니다. 13-23세에는 학업과 기초 능력 발전의 시기, 23-33세는 본격적인 사회 진출과 독립의 시기입니다.',
          wealth: '재물운은 중간 정도입니다. 금 용신을 활용하여 차근차근 저축하는 것이 좋습니다. 큰 투자보다는 안정적인 수입을 선호하며, 부동산이나 금융 관련 분야에서 성과를 기대할 수 있습니다.',
          love: '애정운은 따뜻하고 안정적입니다. 상대방을 배려하는 마음이 깊어 오랜 관계를 유지할 수 있습니다. 다만 자신의 감정을 솔직하게 표현하는 연습이 필요합니다.',
          health: '전반적으로 건강하나 소화기와 호흡기를 주의해야 합니다. 규칙적인 식습관과 적당한 운동으로 건강을 유지하세요.',
          career: '직장 생활이 사업보다 유리합니다. 팀워크가 중요한 분야에서 능력을 발휘하며, 금융, 교육, 공공 부문에서 좋은 성과를 기대할 수 있습니다.',
          study: '학습 능력이 우수하며 특히 인문학과 예술 분야에 재능이 있습니다. 꾸준한 실력을 쌓는 학습법이 잘 맞습니다.',
          promotion: '승진운은 중간 정도입니다. 타인과의 협력과 꾸준한 업무 처리로 좋은 평가를 받을 수 있습니다.',
          move: '이동운은 보통 수준입니다. 새로운 환경에 적응력이 빠르며, 이사나 이직 시 신중하게 결정하면 좋은 결과를 얻을 수 있습니다.',
          travel: '여행운은 좋은 편입니다. 동쪽이나 남쪽 방향의 여행이 특히 좋으며, 가족이나 친구와 함께하는 여행이 추천됩니다.',
          parents: '부모님과의 인연은 깊습니다. 효도의 마음이 강하며 부모님의 건강을 항상 체크하는 것이 중요합니다.',
          siblings: '형제자매와의 관계는 우애가 깊습니다. 서로 도움을 주고받는 관계를 유지하며, 가족 행사 시 중심 역할을 합니다.',
          children: '자녀와의 인연은 깊으며 자녀가 효성이 깊습니다. 자녀 교육에 관심이 많으며 좋은 교육 결과를 기대할 수 있습니다.',
          spouse: '배우자와의 궁합은 좋은 편입니다. 서로를 존중하고 배려하는 관계로 행복한 결혼 생활을 영위할 수 있습니다.',
          social: '대인관계운은 좋습니다. 사교성이 좋고 많은 사람들과 좋은 관계를 유지합니다. 다만 너무 많은 관계보다 진정성 있는 관계에 집중하는 것이 좋습니다.',
          aptitude: '직업 적성은 소통과 교육, 상담 분야에 강점이 있습니다. 창의적인 분야와 분석적인 분야 모두 가능합니다.',
          job: '추천 직업: 교사, 상담사, 금융관련 직종, 예술가, 디자이너, 공무원, 의료 관련 직종 등이 잘 어울립니다.',
          business: '사업 성공 가능성은 중간 수준입니다. 공동 창업이나 파트너십 사업이 유리하며, 서비스업이나 교육 사업을 추천합니다.',
          sinsal: '도화살이 없어 안정적이며, 역마살이 있어 이동과 변화를 좋아합니다. 화개살이 있어 예술적 재능이 있으며, 천을귀인이 있어 위기 시 도움을 받을 수 있습니다.',
          taekil: '2025년 10월 길일: 5일(대길일, 95점), 10일(길일, 90점), 15일(길일, 85점)이 추천됩니다. 특히 5일은 모든 일에 좋으며, 10일은 결혼과 이사에 좋습니다.'
        }
      };
    }

    function displaySajuBasic(data) {
      const pillarsHTML = [
        { label: '년주', char: data.saju.year.hanja },
        { label: '월주', char: data.saju.month.hanja },
        { label: '일주', char: data.saju.day.hanja },
        { label: '시주', char: data.saju.hour.hanja }
      ].map(p => `
        <div class="pillar">
          <div class="pillar-label">${p.label}</div>
          <div class="pillar-char">${p.char}</div>
        </div>
      `).join('');

      const total = Object.values(data.elements).reduce((a, b) => a + b, 0);
      const elementsHTML = Object.entries(data.elements).map(([name, count]) => {
        const percentage = (count / total) * 100;
        const hanja = {목:'木',화:'火',토:'土',금:'金',수:'水'}[name];
        return `
          <div class="element-bar">
            <div class="element-label">
              <span>${name}(${hanja})</span>
              <span>${count}개</span>
            </div>
            <div class="bar">
              <div class="bar-fill element-${name}" style="width: ${percentage}%"></div>
            </div>
          </div>
        `;
      }).join('');

      document.getElementById('sajuBasicInfo').innerHTML = `
        <div class="saju-card">
          <h3>사주 8글자</h3>
          <div class="saju-pillars">${pillarsHTML}</div>
          <p style="text-align: center; margin-top: 15px;">
            일간: <strong style="color: #f39c12; font-size: 18px;">${data.saju.ilgan}</strong>
          </p>
        </div>

        <div class="saju-card">
          <h3>오행 분포</h3>
          <div class="elements-chart">${elementsHTML}</div>
          <p style="text-align: center; margin-top: 15px; padding-top: 15px; border-top: 1px solid #ffd700;">
            신강/신약: <strong style="color: #e74c3c;">${data.strength}</strong> &nbsp;|&nbsp; 
            용신: <strong style="color: #3498db;">${data.yongsin}</strong>
          </p>
        </div>
      `;
    }

    function showCategory(category) {
      currentCategory = category;
      
      document.querySelectorAll('.category-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      event.target.classList.add('active');

      const titles = {
        total: '총운',
        personality: '성격/장단점',
        daeun: '대운',
        wealth: '재물운',
        love: '애정운',
        health: '건강운',
        career: '직업운',
        study: '학업운',
        promotion: '승진운',
        move: '이동운',
        travel: '여행운',
        parents: '부모운',
        siblings: '형제운',
        children: '자녀운',
        spouse: '배우자운',
        social: '대인관계운',
        aptitude: '직업 적성',
        job: '어울리는 직업',
        business: '사업 성공',
        sinsal: '신살',
        taekil: '택일'
      };

      const interpretation = currentSajuData.interpretations[category] || '해당 카테고리의 해석을 준비 중입니다.';

      document.getElementById('categoryResult').innerHTML = `
        <div class="fortune-card">
          <h3>${titles[category]}</h3>
          <p>${interpretation}</p>
        </div>
      `;
    }

    function copySaju() {
      const text = document.getElementById('resultContainer').innerText;
      navigator.clipboard.writeText(text).then(() => {
        alert('내용이 복사되었습니다!');
      }).catch(() => {
        alert('복사 실패');
      });
    }

    window.onload = function() {
      loadUserInfo();
    };
  </script>
</body>
</html>
